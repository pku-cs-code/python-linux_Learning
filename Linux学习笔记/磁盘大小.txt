磁盘大小
数据的存储密度在不同的磁道内可能不同
磁道间隙的密度不一样

磁盘的数据读/写
1）同一盘面的不同磁道（电子切换），然后寻道，就是转移到下一柱面（机械切换）
磁盘是按照柱面来读写数据的，即先读取同一个盘面的磁道，然后不会切换磁道，而是切换磁头，
读取下一个盘面的相同的磁盘，知道所有盘面的相同半径的磁道读取完成之后，数据还没有读写完成，才会切换磁道，这个奇幻磁道的过程称为磁道。
2）磁头的切换是电子切换，而切换磁道需要磁头做径向运动，这个径向运动为步进电机调节，这个动作是机械切换。


MBR：
主引导记录，0磁头0磁道1扇区，446bytes
分区表每个占16bytes，共4个共64bytes
剩下2个bytes为分区结束标志

主分区：引导分区信息+数据
拓展分区：逻辑分区+逻辑分区

1bytes:分区状态
1bytes：分区起始磁头号
2bytes：分区起始扇区和柱面号
1bytes：分区类型
1bytes：分区结束磁头号
2bytes：分区结束扇区和柱面号
4bytes：线性寻址方式下分区相对扇区地址
4bytes：分区大小

[root@test ~]# dd if=/dev/sda of=mbr.bin bs=512 count=1
1+0 records in
1+0 records out
512 bytes (512 B) copied, 0.00046131 s, 1.1 MB/s

[root@test ~]# file mbr.bin
mbr.bin: x86 boot sector; GRand Unified Bootloader, stage1 version 0x3, boot drive 0x80, 1st sector stage2 0x86de, GRUB version 0.94; partition 1: ID=0x83, active, starthead 32, startsector 2048, 409600 sectors; partition 2: ID=0x82, starthead 159, startsector 411648, 409600 sectors; partition 3: ID=0x83, starthead 30, startsector 821248, 11761664 sectors, code offset 0x48

磁盘容量=512bytes（每个扇区字节数）*扇区数*磁道数*磁头数
一个磁道大小：512bytes（一个扇区）*扇区数
磁盘容量=一个柱面的大小（一个磁道大小*磁头数）*磁道数
磁道数=柱面数

分区
一个分区满了，另外的不受影响
不分区直接格式化使用也可以
分区实际上设置16字节的分区表 partion table
分区之后操作系统才能控制磁盘的磁头读取分区表
实质 是对0磁道0扇区的前446字节后面64字节的分区表进行设置
一块磁盘的分区表仅有64bytes大小，仅支持四个分区表信息（主分区+拓展分区）
磁盘分区的最小单位为柱面
拓展分区有自己的分区表，拓展分区下面的逻辑分区可以有多个

磁盘可以有主分区、拓展分区和逻辑分区之分
一块硬盘最多可以有4个主分区（磁盘限制），最多只可以有一个拓展分区，其中一个主分区可以用一个拓展分区代替
且最多只可以代替一个主分区，拓展分区内可以划分为多个逻辑分区，IDE（0-63），sata（0-15）
拓展分区是一个链接，没有MBR，拓展分区不能直接存放数据，受限于操作系统
逻辑分区logical
不能再磁盘中单独划分逻辑分区，逻辑分区必须存在于拓展分区内
拓展分区内可以划分多个逻辑分区，且编号从5开始
拓展分区+主分区
pppp pppe
由于MBR及磁盘分区表大小的限制，即使硬盘还有剩余未分的空间，那么这部分空间也无法使用了
可以3P+E，或者1P+E或者2P+E保留主分区不分完
建立拓展分区后要在上面建立逻辑分区后才可以使用
主分区和逻辑翻去在一般的数据存储上是没有区别的，安装操作系统时第一个分区要选主分区
通过fdisk 分区实际上在改对应的16字节分区表，和分区上的数据没有关系，因此理论上调整分区不会删除分区数据
但是实际上调整分区因为技术问题容易丢数据

Linux通过设备名访问设备
IDE /dev/hd*
SCSI/SAS/SATA/USB /dev/sd*
Linux没有盘符的概念，要此要读取磁盘设备内容需要把创建在分区或逻辑卷上的文件系统挂载到指定的目录上
划分了分区之后还要在分区上创建文件系统

Linux对分区的要求
最少要有/以及swap两个分区（swap 也可以没有）
swap左右：虚拟内存，swap=1.5倍mem大小，内存大于8-16G，那么就用8-16G左右swap
建议设置独立的/boot分区，linux引导分区，存放系统引导文件，如linux内核等，一般只有几十M

文件系统：对存储设备上的数据和元数据进行组织的一种机制
ext2，ext3，ext4，NTFS（windows），FAT（U盘），zfs、xfs、Reiserfs
易于查询和存取数据
分区后能够使用之前必须建立相应的文件系统
文件系统基于存储设备
scsi/sata
reiserfs大量的小文件首选reiserfs
XFS数据库业务
ext4视频下载，流媒体，数据库，小文件业务也可以
ex2 蓝汛的cache业务，一旦数据损坏没有日志不好恢复
5.x常规默认ext3文件系统
6.x常规默认ext4即可
百度21万台服务器

SSD文件系统选择：Ext4/reiserfs、btrfs

LVM事先支持，逻辑卷管理，对分区动态调整，对备份和性能会差一些
分区容量过大，可能导致在频繁读取数据时，磁头寻道震动过大，降低磁盘读写性能

读写都高用raid10（性能更好），如果只读用raid5

fdisk （适合小于2T的分区），parted（适合大于2T的分区）
usermod -s /sbin/nologin username

/etc/skel/.bash_profile添加用户时用户的环境变量存放处

卸载文件系统不能在当前目录下
umount -lf /mnt 强制卸载

磁盘知识
1）外部结构
    正面板标签：产地、规格、容量、条形码、厂家、出厂日期、透气孔、固定螺丝（内六角）
    反面：绿色控制电路板、上面芯片、电容等等
   侧面：电源接口、跳线接口、数据接口（IDE、SAS、SATA）
2）内部结构
    磁头组件（磁头、磁头臂、传动轴、前置控制电路、数据转换器）
    盘片组件(盘片（2-14片）、主轴（转速衡量磁盘性能）、马达)
3）磁盘读写原理
    磁盘读数时，将磁离子（根据离子极性）转化为电脉冲信号的方式
    磁盘读写原理：
磁头在读写数据时，是先读一个盘面的磁道的数据，接下来读下一个盘面相同半径磁道的数据，
即按柱面来读写数据。因为磁头的切换时电子切换，这个速度很快，而切换不同的磁道
或柱面，则需要寻道，寻道就是切换磁道，切换磁道是机械切换，也就是需要通过
步进电机来移动磁头，做径向运动。

4）磁盘分区知识
    磁道：盘片上以盘片圆心为圆心，不同半径的圆形轨迹就是磁道。磁道是圆形的形状
    扇区：磁道上不同半径把磁道分成的圆弧，每个圆弧就是一个扇区，每个扇区是512bytes
    柱面：相同半径不同盘片的磁道组成的圆柱形轨迹。磁道数=柱面数。柱面是分区的基本单位
    盘片：一个磁盘有2-14片不等，一个盘片一般有两个有效面，盘面是从0开始，从上到下依次编号。和磁头的编号一样
    磁头：一个盘片有一般有两个有效盘面，那么一个盘面就会对应一个有效磁头。磁头数=盘面数=盘片数*2

5）分区规划：
分区的实质是划分柱面号和扇区号
一块硬盘最多4个主分区或3个主分区+1个拓展分区（只能有一个拓展分区，操作系统限制）
硬盘分区表总共有64bytes，在0磁道1扇区正数前446字节后面接着的64个字节，这个限制是磁盘出厂就限制了
拓展分区不能使用，必须要创建逻辑分区才可以使用

6）文件系统介绍
文件系统时组织数据或存储数据的一个机制或者方法。
磁盘在分区后使用前必须要格式化，创建文件系统，只有创建了文件系统，操作系统才可以识别磁盘文件组织格式，进而存储数据。

ext2 蓝汛cache服务器
ext3（在ext2的基础上加了日志的功能，便于恢复数据用，5.x，常规应用ext3）
ext4（6.x） 视频、流媒体
xfs 淘宝的数据库应用xfs
jfs
reiserfs4 适合小文件系统，默认情况操作系统不支持，需要单独安装






